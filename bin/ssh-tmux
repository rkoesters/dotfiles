#!/bin/sh
if [ $# -eq 0 ]; then
	echo "usage: $0 [user@]hostname" >&2
	exit 1
fi
session="$(basename $0)"
exec ssh -t "$@" "
tmux attach-session ||
(
	tmux new-session -d -s \"$session\" &&
	tmux send-keys -t \"$session:0.0\" \"exec irssi\" Enter &&
	tmux new-window -a -t \"$session:0\" &&
	tmux attach-session -t \"$session\"
)
"
